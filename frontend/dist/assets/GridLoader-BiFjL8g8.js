import{c as r,d as v,k as s,b as t,F as T,g as U,t as n,n as m,V as Oe,M as je,z as Be,r as u,y as pe,m as w,o as fe,w as He,p as xe,s as F,i as C,e as R,v as E,h as P,D as Ke,q as me,J as We,W as q,X as Ge,Y as Xe,K as Ye,R as qe}from"./index-CbJ9Xo6G.js";import{u as Je}from"./productos-Cr0wCfAx.js";import{u as Qe}from"./pedidos-B1wW5O8Q.js";import"./productosApi-B95eMTcM.js";const Ze={class:"bg-black/40 px-3 py-2 border-b border-slate-700 flex justify-between items-center"},et={class:"max-h-64 overflow-y-auto custom-scrollbar bg-[#111]"},tt={key:0,class:"p-4 text-center text-xs opacity-50 italic"},ot={class:"flex justify-between items-baseline mb-1"},lt={class:"font-mono text-xs font-bold text-amber-500"},st={class:"font-mono text-xs font-medium opacity-70"},at={class:"space-y-0.5 mt-2"},nt={class:"truncate pr-2"},rt={class:"font-mono opacity-60"},it={key:0,class:"text-[9px] text-slate-600 italic"},dt={class:"mt-2 text-right"},ut={__name:"ClientHistoryPopover",props:{visible:Boolean,x:Number,y:Number,orders:{type:Array,default:()=>[]}},emits:["close"],setup($){const g=p=>p?new Date(p).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit"}):"",I=p=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",maximumFractionDigits:0}).format(p),V=p=>p==="CUMPLIDO"?"text-emerald-400 border-emerald-900":p==="PENDIENTE"?"text-amber-400 border-amber-900":"text-slate-400";return(p,y)=>$.visible?(s(),r("div",{key:0,class:"absolute z-[70] bg-[#1a1a1a] text-slate-200 rounded-lg shadow-2xl border border-slate-700 w-80 overflow-hidden font-sans",style:Oe({top:$.y+"px",left:$.x+"px"})},[t("div",Ze,[y[2]||(y[2]=t("span",{class:"text-[10px] uppercase font-bold tracking-widest text-[#54cb9b]"},"Historial Reciente",-1)),t("button",{onClick:y[0]||(y[0]=f=>p.$emit("close")),class:"text-slate-500 hover:text-white transition-colors"},[...y[1]||(y[1]=[t("i",{class:"fa-solid fa-times text-xs"},null,-1)])])]),t("div",et,[$.orders.length===0?(s(),r("div",tt," Sin pedidos recientes. ")):v("",!0),(s(!0),r(T,null,U($.orders,f=>(s(),r("div",{key:f.id,class:"border-b border-slate-800/50 p-3 hover:bg-white/5 transition-colors group"},[t("div",ot,[t("span",lt,n(g(f.fecha)),1),t("span",st,n(I(f.total)),1)]),t("div",at,[(s(!0),r(T,null,U(f.items.slice(0,3),_=>(s(),r("div",{key:_.id,class:"flex justify-between text-[10px] text-slate-400"},[t("span",nt,n(_.producto_nombre||_.producto_id),1),t("span",rt,n(I(_.precio_unitario)),1)]))),128)),f.items.length>3?(s(),r("div",it," + "+n(f.items.length-3)+" productos más... ",1)):v("",!0)]),t("div",dt,[t("span",{class:m(["text-[9px] uppercase font-bold px-1.5 py-0.5 rounded border border-slate-700 opacity-60 group-hover:opacity-100 transition-opacity",V(f.estado)])},n(f.estado),3)])]))),128))])],4)):v("",!0)}},ct={class:"flex flex-col h-full font-sans bg-[#0b211f] text-emerald-50 transition-colors duration-500 ease-in-out"},vt={class:"grid grid-cols-[100px_1fr_120px_180px] grid-rows-2 gap-px bg-slate-800 border-b border-slate-700 shrink-0 select-none text-xs"},pt={class:"bg-[#0f172a] text-slate-400 flex flex-col justify-center px-2 py-1"},ft={class:"text-emerald-400 font-mono font-bold text-sm leading-none"},xt={class:"bg-[#1e293b] relative group flex flex-col justify-center px-1"},mt={class:"flex items-center justify-between pointer-events-none absolute inset-x-2 top-1 z-10"},bt={key:2,class:"absolute top-full left-0 w-full bg-[#0d2623] text-emerald-100 shadow-xl rounded-b z-50 max-h-80 overflow-y-auto border border-emerald-900 border-t-0"},gt=["onMousedown","onContextmenu"],ht={class:"text-[10px] opacity-50 font-mono flex items-center gap-2 text-emerald-400"},yt={key:0,class:"bg-red-900 text-red-100 px-1 rounded text-[8px] uppercase font-bold"},wt={class:"flex items-center gap-2"},_t={key:0,class:"text-[9px] bg-amber-900/50 text-amber-500 px-1.5 rounded-full border border-amber-900"},kt={key:0,class:"p-2 text-center text-xs opacity-50 italic"},Ct={class:"bg-[#0f172a] flex flex-col justify-center px-2 py-1"},Et={class:"bg-[#020617] text-right flex flex-col justify-center px-3 row-span-2 border-l border-slate-700"},It={class:"text-2xl font-mono font-bold text-emerald-400 tracking-tight leading-none"},Dt={class:"text-[10px] text-slate-600 mt-1 font-mono"},St={class:"bg-[#0f172a] flex items-center px-2 border-t border-slate-800"},Nt={class:"font-mono text-emerald-100/80 ml-1 select-all h-full flex items-center"},Pt={class:"bg-[#1e293b] flex items-center col-span-2 border-t border-slate-700 divide-x divide-slate-700 relative z-30"},Tt={class:"flex flex-col leading-none ml-1 overflow-hidden"},Ut={class:"font-bold truncate text-slate-300 text-[10px]"},$t={class:"text-[9px] text-slate-500 truncate"},Lt={class:"w-20 h-full bg-slate-200 relative border-r border-slate-300"},Mt={class:"flex-1 h-full bg-slate-200 relative"},At={class:"flex items-center gap-1 shrink-0 px-2 bg-[#1e293b]"},Ft=["title"],Rt={class:"h-8 flex items-center bg-[#0d1f1c] rounded-md mx-2 px-1 border border-emerald-900/40"},Vt=["onClick","title"],zt={key:0,class:"flex flex-col items-center justify-center h-48 opacity-30 select-none pointer-events-none"},Ot=["onClick"],jt={class:"w-10 text-center text-xs text-emerald-800 font-mono select-none"},Bt={class:"w-24 font-bold text-emerald-400 text-xs truncate select-all"},Ht=["title"],Kt={class:"flex-1 px-2"},Wt=["onUpdate:modelValue","onFocus"],Gt={class:"w-20 text-center"},Xt=["onUpdate:modelValue","onFocus"],Yt={class:"w-12 text-center text-[10px] text-emerald-600 uppercase select-none"},qt={class:"w-24 text-right font-mono"},Jt=["onUpdate:modelValue","onFocus"],Qt={class:"w-24 text-right font-bold font-mono text-emerald-100 text-sm"},Zt=["onClick"],eo={class:"flex-1 relative"},to=["placeholder"],oo={key:0,class:"absolute bottom-full left-0 mb-3 w-full bg-[#0d2623] text-emerald-100 shadow-2xl rounded-lg border border-emerald-900 z-50 overflow-hidden"},lo={class:"px-3 py-1.5 bg-black/30 backdrop-blur text-[10px] text-emerald-400 uppercase tracking-wider flex justify-between border-b border-emerald-900/30"},so={class:"max-h-80 overflow-y-auto"},ao=["onMousedown","onMouseover"],no={class:"flex-1 min-w-0"},ro={class:"font-bold text-sm flex items-center gap-2 truncate"},io={class:"text-[10px] opacity-60 font-mono flex gap-3 mt-0.5"},uo={class:"bg-white/10 px-1 rounded"},co={key:0},vo={class:"text-right shrink-0"},po={class:"font-mono font-bold text-emerald-400 group-hover:text-emerald-300"},fo={class:"absolute -top-3 left-6"},xo={class:"bg-white border border-slate-200 text-[10px] px-3 py-1 rounded-full shadow-sm cursor-pointer hover:border-blue-400 hover:text-blue-600 flex items-center gap-2 transition-all text-slate-500 font-bold tracking-tight"},mo={class:"text-slate-700"},bo={class:"flex items-end justify-between gap-8"},go={class:"flex-1 max-w-xl"},ho={class:"flex gap-8 items-end pb-1"},yo={class:"text-right space-y-0.5"},wo={class:"font-mono text-slate-500 text-sm"},_o={key:0,class:"text-right space-y-0.5"},ko={class:"font-mono text-slate-500 text-sm"},Co={class:"text-right pl-6 border-l border-slate-200"},Eo={class:"text-3xl font-bold font-mono leading-none tracking-tight text-slate-800"},Io={class:"flex items-center gap-3 ml-auto"},Do={key:0,class:"fa-solid fa-check text-white text-[8px]"},So={key:0,class:"animate-spin"},No={key:1,class:"flex items-center gap-2"},Po={key:0,class:"fixed inset-0 z-[60] flex justify-end bg-black/50 backdrop-blur-sm"},To={class:"w-full max-w-lg h-full shadow-2xl overflow-y-auto transform transition-transform duration-300"},Uo={class:"bg-[#0f172a] w-96 rounded-lg border border-slate-700 shadow-2xl p-4"},$o={key:0,class:"space-y-2 max-h-[60vh] overflow-y-auto custom-scrollbar"},Lo=["onClick"],Mo={class:"font-bold text-slate-200"},Ao={class:"text-xs text-slate-500"},Fo={class:"text-[10px] text-emerald-600 mt-1"},Ro={key:1,class:"text-slate-500 text-sm italic text-center py-4"},Vo={__name:"GridLoader",setup($){const g=Be(),I=Je(),V=Qe(),p=u("CLIENT"),y=u(null),f=u(null),_=u(null),K=u(null),h=u(""),z=u(""),k=u(!1),L=u(0),D=u(0),b=u({show:!1,x:0,y:0,orders:[]}),J=u(!1);u(null);const W=u(!1),O=u(!1),Q=u(null),G=u(!1),S=u({show:!1,x:0,y:0,actions:[]}),Z=u(!1),ee=pe(),be=w(()=>ee.segmentos),ge=()=>{Z.value=!0},he=async o=>{try{await ee.createSegmento({nombre:o})}catch(e){alert(e.message)}},ye=async o=>{try{await ee.deleteSegmento(o)}catch(e){alert("No se puede eliminar: "+e.message)}},i=u({fecha:new Date().toISOString().split("T")[0],oc:"",nota:"",estado:"PENDIENTE",numero_manual:""}),we=[{value:"PRESUPUESTO",label:"PRESUPUESTO",activeClass:"bg-indigo-900/50 text-indigo-300 border border-indigo-500/50 shadow-sm",dotClass:"bg-indigo-800"},{value:"PENDIENTE",label:"PEDIDO FIRME",activeClass:"bg-emerald-900/50 text-emerald-300 border border-emerald-500/50 shadow-sm",dotClass:"bg-emerald-800"}],ae=u(0),j=u(!1),a=u(null),x=u([]);w(()=>i.value.estado==="PRESUPUESTO"?"bg-[#1a0b1e] border-purple-900 text-purple-400":i.value.estado==="PENDIENTE"?"bg-[#061816] border-emerald-900 text-emerald-400":"bg-[#0f0a1e] border-purple-900 text-purple-400");const _e=w(()=>i.value.estado==="PRESUPUESTO"?"bg-[#2d1b36]":"bg-[#0b211f]"),B=w(()=>{if(h.value.length<2)return[];const o=l=>l?l.toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):"",e=o(h.value);return g.clientes.filter(l=>{if(!l.activo)return!1;const d=o(l.razon_social),c=l.cuit||"";return d.includes(e)||c.includes(e)}).sort((l,d)=>{if(l.activo&&!d.activo)return-1;if(!l.activo&&d.activo)return 1;const c=o(l.razon_social),ve=o(d.razon_social);return c.startsWith(e)&&!ve.startsWith(e)?-1:!c.startsWith(e)&&ve.startsWith(e)?1:0}).slice(0,15)}),te=w(()=>{if(!a.value)return null;const o=a.value;if(o.razon_social==="CONSUMIDOR FINAL"||o.cuit==="00-00000000-0")return{color:"text-emerald-500",text:"Auditado (CF)",missing:[]};const e=[];return o.cuit||e.push("CUIT"),o.domicilio_fiscal_resumen||e.push("Domicilio Fiscal"),!o.condicion_iva_id&&!o.condicion_iva&&e.push("Condición IVA"),!o.segmento_id&&!o.segmento&&e.push("Segmento"),e.length===0?{color:"text-emerald-500",text:"Auditado",missing:[]}:{color:"text-amber-500",text:"Datos Incompletos",missing:e,title:"Faltan: "+e.join(", ")}}),M=w(()=>{const o=l=>l?l.toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):"",e=o(z.value);return e?I.productos.filter(l=>{const d=o(l.nombre),c=o(l.sku);return d.includes(e)||c.includes(e)}).slice(0,50):[]}),X=w(()=>p.value==="PRODUCT"&&M.value.length>0),ke=w(()=>{const o=I.productos.length;return o>0?`+ Agregar Producto (F3 para buscar en ${o} ítems)`:"Cargando catálogo..."}),A=w(()=>{const o=x.value.reduce((l,d)=>l+d.cantidad*d.precio_unitario,0),e=i.value.estado==="PENDIENTE"?o*.21:0;return{neto:o,iva:e,final:o+e}}),Ce=w(()=>{if(!a.value)return"Retiro en Local";const o=!!a.value.domicilio_entrega,e=a.value.transporte_nombre;return e&&e!=="Retiro Local"?e:o?"Envío a Domicilio":"Retira en Local"}),Ee=o=>{a.value&&(a.value.transporte_id=o.transporte_id,a.value.transporte_nombre=o.transporte_nombre,a.value.domicilio_entrega=o.domicilio_entrega),j.value=!1},Ie=()=>{confirm("¿Borrar todo y limpiar pantalla localmente?")&&(x.value=[],a.value=null,i.value.nota="",i.value.oc="",i.value.estado="PENDIENTE",h.value="",localStorage.removeItem("tactical_draft"),Y(),setTimeout(()=>H(),100))},N=o=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(o),Y=async()=>{try{const o=await Ye.get("/pedidos/sugerir_id");ae.value=o.data,i.value.numero_manual=o.data}catch(o){console.error("Error fetching next ID",o)}},De=()=>{const o={items:x.value,form:i.value,selectedClient:a.value,timestamp:Date.now()};localStorage.setItem("tactical_draft",JSON.stringify(o))},Se=()=>{localStorage.removeItem("tactical_draft"),x.value=[],i.value.nota="",i.value.oc="",i.value.estado="PENDIENTE",i.value.cliente_id=null,a.value=null,h.value=""};fe(async()=>{p.value="CLIENT";const o=localStorage.getItem("tactical_draft");if(o)try{const e=JSON.parse(o);Date.now()-e.timestamp<1440*60*1e3&&(e.items?.length>0||e.selectedClient)&&(x.value=e.items||[],i.value={...i.value,...e.form},a.value=e.selectedClient,h.value=e.selectedClient?.razon_social||"")}catch(e){console.error("Error restoring draft",e)}setTimeout(()=>f.value?.focus(),100),Promise.all([g.fetchClientes(),I.fetchProductos(),pe().fetchAll(),Y()])}),He([x,()=>i.value,a],()=>{(x.value.length>0||a.value)&&De()},{deep:!0}),xe(()=>{});const H=()=>{p.value="CLIENT",f.value?.focus(),f.value?.select(),k.value=!0},Ne=o=>{o.key==="ArrowDown"?(o.preventDefault(),L.value=Math.min(L.value+1,B.value.length-1)):o.key==="ArrowUp"?(o.preventDefault(),L.value=Math.max(L.value-1,0)):o.key==="Enter"?(o.preventDefault(),B.value.length>0&&oe(B.value[L.value])):o.key==="Escape"?(k.value=!1,f.value?.blur()):k.value=!0},Pe=()=>{h.value===""&&(a.value=null),k.value=!0},Te=()=>{h.value="",a.value=null,k.value=!1,f.value?.focus()},oe=async o=>{a.value=o,h.value=o.razon_social,k.value=!1;try{const e=await g.fetchClienteById(o.id);e&&(a.value=e)}catch(e){console.error("Error fetching client details",e)}se()},ne=()=>{Q.value={razon_social:h.value||"",cuit:"",activo:!0},G.value=!0,O.value=!0,k.value=!1},re=o=>{Q.value=o,G.value=!1,O.value=!0,k.value=!1},le=()=>{O.value=!1,a.value||H()},Ue=async o=>{try{let e;G.value?e=await g.createCliente(o):e=await g.updateCliente(o.id,o),oe(e),le()}catch(e){console.error(e),alert("Error al guardar cliente: "+e.message)}},$e=async o=>{try{await g.deleteCliente(o.id),le(),h.value&&g.fetchClientes()}catch(e){console.error(e)}},Le=o=>{const e=g.clientes.find(l=>l.id===o);e&&re(e)},ie=(o,e)=>{const l=e||a.value;l&&(S.value={show:!0,x:o.clientX,y:o.clientY,actions:[{label:"Ver Historial (Últ. 5)",iconClass:"fas fa-history",handler:async()=>{b.value.x=o.clientX,b.value.y=o.clientY,b.value.orders=await V.getHistorialCliente(l.id),b.value.show=!0}},{label:"Editar Cliente",iconClass:"fas fa-edit",handler:()=>re(l)},{label:"Eliminar Cliente",iconClass:"fas fa-trash",handler:()=>Ae(l),class:"text-red-400 hover:text-red-300"}]})},Me=o=>{a.value&&ie(o,a.value)},Ae=async o=>{if(confirm(`¿Marcar a "${o.razon_social}" para eliminación (Baja)?`))try{await g.deleteCliente(o.id)}catch(e){alert("Error al eliminar: "+e.message)}},se=()=>{p.value="PRODUCT",_.value?.focus()},Fe=o=>{o.key==="ArrowDown"?(o.preventDefault(),X.value&&(D.value=Math.min(D.value+1,M.value.length-1))):o.key==="ArrowUp"?(o.preventDefault(),X.value&&(D.value=Math.max(D.value-1,0))):o.key==="Enter"?(o.preventDefault(),X.value&&M.value.length>0&&de(M.value[D.value])):o.key==="Escape"&&(z.value="",_.value?.blur())},de=o=>{x.value.push({_ui_id:Date.now()+Math.random(),id:o.id,sku:o.sku||"N/A",nombre:o.nombre,unidad:o.unidad_venta||"UN",cantidad:1,precio_unitario:o.precio_sugerido||0}),z.value="",D.value=0,qe(()=>{K.value&&(K.value.scrollTop=K.value.scrollHeight),_.value?.focus()})},Re=o=>{x.value.splice(o,1)},ue=async()=>{if(!a.value)return alert("Por favor seleccione un cliente.");if(x.value.length===0)return alert("El pedido está vacío.");J.value=!0;try{const o={cliente_id:a.value.id,fecha:i.value.fecha,nota:i.value.nota,oc:i.value.oc,estado:i.value.estado,items:x.value.map(l=>({producto_id:l.id,cantidad:l.cantidad,precio_unitario:l.precio_unitario}))},e=await V.createPedidoTactico(o);confirm(`Pedido #${e.id} generado con éxito.
¿Limpiar pantalla?`)&&(Se(),H(),Y())}catch(o){alert("Error al guardar: "+o.message)}finally{J.value=!1}},Ve=async o=>{a.value&&(b.value.x=o.clientX,b.value.y=o.clientY+20,b.value.orders=await V.getHistorialCliente(a.value.id),b.value.show=!0)},ze=()=>{b.value.show=!1},ce=o=>{o.key==="F3"?(o.preventDefault(),H()):o.key==="F2"?(o.preventDefault(),se()):o.key==="F10"?(o.preventDefault(),O.value||ue()):o.key==="F4"&&p.value==="CLIENT"&&(o.preventDefault(),ne())};return fe(async()=>{window.addEventListener("keydown",ce),g.clientes.length===0&&await g.fetchClientes(),I.productos.length===0&&await I.fetchProductos(),H(),Y()}),xe(()=>{window.removeEventListener("keydown",ce)}),(o,e)=>(s(),r("div",ct,[t("header",vt,[t("div",pt,[e[17]||(e[17]=t("span",{class:"text-[9px] uppercase font-bold tracking-widest opacity-50"},"PEDIDO #",-1)),t("span",ft,n(i.value.numero_manual||ae.value||"NEW"),1)]),t("div",xt,[t("div",mt,[e[19]||(e[19]=t("span",{class:"text-[9px] font-bold text-slate-500"},"CLIENTE (F3)",-1)),te.value?(s(),r("span",{key:0,class:m([te.value.color,"text-[9px] font-bold uppercase tracking-wider flex items-center gap-1"])},[e[18]||(e[18]=t("i",{class:"fas fa-circle text-[6px]"},null,-1)),R(" "+n(te.value.text),1)],2)):v("",!0)]),C(t("input",{ref_key:"clientInput",ref:f,type:"text",class:m(["w-full h-full bg-transparent pt-3 pb-0 px-1 outline-none text-emerald-100 font-bold placeholder-slate-600 focus:bg-slate-700/50 transition-colors cursor-text pr-6",{"bg-slate-700/50":p.value==="CLIENT"}]),placeholder:"BUSCAR CLIENTE...","onUpdate:modelValue":e[0]||(e[0]=l=>h.value=l),onInput:Pe,onFocus:e[1]||(e[1]=l=>p.value="CLIENT"),onKeydown:Ne,onContextmenu:P(Me,["prevent"])},null,34),[[E,h.value]]),h.value?(s(),r("button",{key:0,onClick:Te,class:"absolute right-6 top-1/2 -translate-y-0 text-slate-500 hover:text-rose-500 z-20 px-2",tabindex:"-1"},[...e[20]||(e[20]=[t("i",{class:"fa-solid fa-times"},null,-1)])])):v("",!0),a.value?(s(),r("div",{key:1,class:"absolute right-1 bottom-1 text-slate-500 hover:text-emerald-400 cursor-help",onMouseenter:Ve,onMouseleave:ze},[...e[21]||(e[21]=[t("i",{class:"fa-solid fa-clock-rotate-left"},null,-1)])],32)):v("",!0),k.value?(s(),r("div",bt,[(s(!0),r(T,null,U(B.value,(l,d)=>(s(),r("div",{key:l.id,class:m(["px-3 py-1.5 border-b border-emerald-900/30 hover:bg-emerald-900/50 cursor-pointer flex justify-between items-center group relative select-none text-xs",{"bg-emerald-900/50":d===L.value}]),onMousedown:P(c=>oe(l),["left"]),onContextmenu:P(c=>ie(c,l),["prevent"])},[t("div",null,[t("span",{class:m(["font-bold block",l.activo?"text-emerald-100":"line-through text-slate-500"])},n(l.razon_social),3),t("span",ht,[R(n(l.cuit)+" ",1),l.activo?v("",!0):(s(),r("span",yt,"INACTIVO"))])]),t("div",wt,[l.domicilios?.length>1?(s(),r("div",_t," Multi-Sede ")):v("",!0)])],42,gt))),128)),B.value.length===0?(s(),r("div",kt,[e[22]||(e[22]=t("p",null,"No hay coincidencias.",-1)),t("p",{class:"font-bold cursor-pointer text-blue-500 hover:underline mt-1",onMousedown:ne}," (F4) Crear Nuevo Cliente ",32)])):v("",!0)])):v("",!0)]),t("div",Ct,[e[23]||(e[23]=t("span",{class:"text-[9px] uppercase font-bold tracking-widest text-slate-500"},"FECHA",-1)),C(t("input",{type:"date",class:"bg-transparent text-xs text-emerald-100 focus:outline-none cursor-pointer font-mono font-bold w-full","onUpdate:modelValue":e[2]||(e[2]=l=>i.value.fecha=l)},null,512),[[E,i.value.fecha]])]),t("div",Et,[e[24]||(e[24]=t("span",{class:"text-[9px] uppercase font-bold tracking-widest text-emerald-600 mb-1"},"TOTAL ESTIMADO",-1)),t("span",It,n(N(A.value.final)),1),t("span",Dt,n(x.value.length)+" ITEM(S) | "+n(N(A.value.iva))+" IVA ",1)]),t("div",St,[e[25]||(e[25]=t("span",{class:"text-[9px] font-bold text-slate-500 w-8"},"CUIT:",-1)),t("span",Nt,n(a.value?.cuit||"-"),1)]),t("div",Pt,[t("div",{class:"flex items-center gap-1 px-3 cursor-pointer hover:text-emerald-400 transition-colors h-full min-w-[30%] max-w-[40%]",title:"Cambiar Logística / Domicilio",onClick:e[3]||(e[3]=l=>j.value=!0)},[e[26]||(e[26]=t("i",{class:"fa-solid fa-truck text-[10px] text-slate-500 shrink-0"},null,-1)),t("div",Tt,[t("span",Ut,n(Ce.value),1),t("span",$t,n(a.value?.domicilio_entrega||"Sin dirección de entrega"),1)]),e[27]||(e[27]=t("i",{class:"fa-solid fa-caret-down text-[10px] text-slate-600 ml-auto pl-2"},null,-1))]),t("div",Lt,[C(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=l=>i.value.oc=l),placeholder:"O.C.",autocomplete:"off",class:"w-full h-full px-2 text-[10px] text-slate-900 placeholder-slate-500 font-bold outline-none transition-colors text-center border-none bg-transparent",title:"Orden de Compra"},null,512),[[E,i.value.oc]])]),t("div",Mt,[C(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=l=>i.value.nota=l),placeholder:"Observaciones del Pedido...",autocomplete:"off",class:"w-full h-full px-3 text-[10px] text-slate-900 placeholder-slate-500 font-bold outline-none transition-colors border-none bg-transparent",style:{color:"#0f172a !important"}},null,512),[[E,i.value.nota]])]),t("div",At,[e[28]||(e[28]=t("span",{class:"text-[9px] font-bold text-slate-500"},"IVA:",-1)),t("span",{class:"font-bold text-slate-300 truncate max-w-[80px]",title:a.value?.condicion_iva_nombre},n(a.value?.condicion_iva_nombre||"-"),9,Ft)])]),t("div",Rt,[(s(),r(T,null,U(we,l=>t("button",{key:l.value,class:m(["px-3 h-6 text-[10px] font-bold uppercase rounded transition-all mr-1 last:mr-0 flex items-center gap-1",i.value.estado===l.value?l.activeClass:"text-slate-500 hover:text-slate-300"]),onClick:d=>i.value.estado=l.value,title:l.label},[t("div",{class:m(["w-2 h-2 rounded-full",i.value.estado===l.value?"bg-current":l.dotClass])},null,2),R(" "+n(l.label),1)],10,Vt)),64))])]),t("main",{class:m(["flex-1 relative flex flex-col overflow-hidden transition-colors duration-500",_e.value])},[e[35]||(e[35]=Ke('<div class="flex px-4 py-2 text-[10px] font-bold uppercase tracking-widest text-emerald-600/60 border-b border-emerald-900/30 shrink-0 bg-[#061816]" data-v-22d915d6><div class="w-10 text-center" data-v-22d915d6>#</div><div class="w-24" data-v-22d915d6>SKU</div><div class="w-64 pl-2" data-v-22d915d6>Descripción</div><div class="flex-1 pl-2" data-v-22d915d6>Notas / Obs</div><div class="w-20 text-center" data-v-22d915d6>Cant.</div><div class="w-12 text-center" data-v-22d915d6>Unid.</div><div class="w-24 text-right" data-v-22d915d6>Unitario</div><div class="w-24 text-right" data-v-22d915d6>Subtotal</div><div class="w-8" data-v-22d915d6></div></div>',1)),t("div",{ref_key:"gridContainer",ref:K,class:"flex-1 overflow-y-auto custom-scrollbar relative px-4 py-1 space-y-0.5",onClick:se},[x.value.length===0?(s(),r("div",zt,[...e[29]||(e[29]=[t("i",{class:"fa-solid fa-keyboard text-4xl mb-2"},null,-1),t("p",{class:"text-sm"},"Empieza escribiendo el nombre de un producto...",-1)])])):v("",!0),(s(!0),r(T,null,U(x.value,(l,d)=>(s(),r("div",{key:l._ui_id,class:m(["flex items-center py-1 border-b border-emerald-900/30 hover:bg-white/5 group transition-colors text-sm rounded px-1",{"bg-[#061816] ring-1 ring-emerald-500/50":y.value===d}]),onClick:P(c=>y.value=d,["stop"])},[t("div",jt,n(d+1),1),t("div",Bt,n(l.sku),1),t("div",{class:"w-64 font-medium text-emerald-100 pl-2 truncate select-all",title:l.nombre},n(l.nombre),9,Ht),t("div",Kt,[C(t("input",{type:"text","onUpdate:modelValue":c=>l.nota=c,class:"w-full bg-transparent text-xs text-emerald-200/70 placeholder-emerald-900/50 outline-none focus:text-emerald-100 focus:bg-white/5 rounded px-1",placeholder:"...",onFocus:c=>y.value=d},null,40,Wt),[[E,l.nota]])]),t("div",Gt,[C(t("input",{type:"number","onUpdate:modelValue":c=>l.cantidad=c,class:"w-16 text-center bg-transparent hover:bg-white/10 focus:bg-black/20 rounded outline-none focus:ring-1 focus:ring-emerald-500 font-mono font-bold text-white",min:"0",onFocus:c=>y.value=d},null,40,Xt),[[E,l.cantidad,void 0,{number:!0}]])]),t("div",Yt,n(l.unidad||"UN"),1),t("div",qt,[C(t("input",{type:"number","onUpdate:modelValue":c=>l.precio_unitario=c,class:"w-20 text-right bg-transparent hover:bg-white/10 focus:bg-black/20 outline-none focus:ring-1 focus:ring-emerald-500 rounded px-1 text-emerald-300 text-xs",step:"0.01",onFocus:c=>y.value=d},null,40,Jt),[[E,l.precio_unitario,void 0,{number:!0}]])]),t("div",Qt,n(N(l.cantidad*l.precio_unitario)),1),t("div",{class:"w-8 text-center opacity-0 group-hover:opacity-100 cursor-pointer text-emerald-700 hover:text-red-400 transition-opacity",onClick:P(c=>Re(d),["stop"])},[...e[30]||(e[30]=[t("i",{class:"fa-solid fa-times"},null,-1)])],8,Zt)],10,Ot))),128)),t("div",{class:m(["flex items-center py-2 mt-2 bg-[#020a0f] border border-emerald-900/50 shadow-sm rounded-md px-2 sticky bottom-2 z-10",{"ring-1 ring-emerald-500 border-emerald-500":p.value==="PRODUCT"}]),onClick:e[8]||(e[8]=P(()=>{},["stop"]))},[e[34]||(e[34]=t("div",{class:"w-10 text-center text-xs text-emerald-800 font-bold"},"+",-1)),t("div",eo,[C(t("input",{ref_key:"productInput",ref:_,type:"text",class:"w-full bg-transparent outline-none placeholder-emerald-800 font-bold text-emerald-100",placeholder:ke.value,"onUpdate:modelValue":e[6]||(e[6]=l=>z.value=l),onFocus:e[7]||(e[7]=l=>p.value="PRODUCT"),onKeydown:Fe},null,40,to),[[E,z.value]]),X.value?(s(),r("div",oo,[t("div",lo,[t("span",null,[R("Coincidencias ("+n(M.value.length)+") ",1),e[31]||(e[31]=t("span",{class:"text-emerald-500 ml-2"},"Use Flechas y Enter",-1))]),e[32]||(e[32]=t("span",{class:"text-xs font-bold text-amber-400"},"ESC para cerrar",-1))]),t("div",so,[(s(!0),r(T,null,U(M.value,(l,d)=>(s(),r("div",{key:l.id,class:m(["px-4 py-2 border-b border-emerald-900/10 cursor-pointer flex justify-between items-center transition-colors gap-4 group",d===D.value?"bg-emerald-600 text-white":"hover:bg-white/5"]),onMousedown:c=>de(l),onMouseover:c=>D.value=d},[t("div",no,[t("div",ro,n(l.nombre),1),t("div",io,[t("span",uo,n(l.sku),1),l.rubro_nombre?(s(),r("span",co,n(l.rubro_nombre),1)):v("",!0)])]),t("div",vo,[t("div",po,n(N(l.precio_sugerido||0)),1),e[33]||(e[33]=t("div",{class:"text-[10px] opacity-40"},"Lista",-1))])],42,ao))),128))])])):v("",!0)])],2)],512)],2),t("footer",{class:m(["relative z-40 px-6 py-4 border-t border-emerald-900/30 shadow-[0_-4px_20px_rgba(0,0,0,0.2)] transition-colors",i.value.tipo==="PEDIDO"?"bg-[#061816]":"bg-[#0f0a1e]"])},[t("div",fo,[t("div",xo,[e[37]||(e[37]=t("i",{class:"fa-solid fa-truck"},null,-1)),t("span",null,[e[36]||(e[36]=R("Logística: ",-1)),t("b",mo,n(a.value?.transporte_nombre||"Retiro en Local"),1)]),e[38]||(e[38]=t("i",{class:"fa-solid fa-chevron-down opacity-50 text-[9px]"},null,-1))])]),t("div",bo,[t("div",go,[C(t("textarea",{class:"w-full h-12 bg-white border border-slate-200 rounded-lg p-2 text-xs text-slate-900 outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-400 resize-none placeholder-slate-400 transition-all shadow-inner",placeholder:"Notas internas, instrucciones de entrega o comentarios del pedido...","onUpdate:modelValue":e[9]||(e[9]=l=>i.value.nota=l)},null,512),[[E,i.value.nota]])]),t("div",ho,[t("div",yo,[e[39]||(e[39]=t("div",{class:"text-[10px] text-slate-400 uppercase font-bold tracking-wider"},"Subtotal",-1)),t("div",wo,n(N(A.value.neto)),1)]),A.value.iva>0?(s(),r("div",_o,[e[40]||(e[40]=t("div",{class:"text-[10px] text-slate-400 uppercase font-bold tracking-wider"},"IVA (21%)",-1)),t("div",ko,n(N(A.value.iva)),1)])):v("",!0),t("div",Co,[t("div",{class:m(["text-[10px] uppercase font-bold tracking-wider mb-0.5",i.value.tipo==="PEDIDO"?"text-emerald-600":"text-purple-600"])},"Total Final",2),t("div",Eo,n(N(A.value.final)),1)])]),t("div",Io,[t("div",{class:"flex items-center gap-2 bg-[#061816]/50 px-3 py-2 rounded-lg border border-emerald-900/30 text-[10px] text-emerald-400 select-none cursor-pointer hover:bg-[#061816]/80 transition-colors",onClick:e[10]||(e[10]=l=>W.value=!W.value)},[t("div",{class:m(["w-3 h-3 rounded-sm border border-emerald-600 flex items-center justify-center transition-colors",{"bg-emerald-600":W.value}])},[W.value?(s(),r("i",Do)):v("",!0)],2),e[41]||(e[41]=t("span",{class:"font-bold"},"Generar Excel",-1))]),x.value.length>0||a.value?(s(),r("button",{key:0,class:"h-12 px-4 rounded-lg bg-slate-800 text-slate-400 hover:text-rose-400 hover:bg-slate-700 transition-colors font-bold text-xs uppercase tracking-wider flex items-center gap-2 border border-slate-700",onClick:Ie,title:"Limpiar pantalla y borrar borrador"},[...e[42]||(e[42]=[t("i",{class:"fa-solid fa-trash"},null,-1)])])):v("",!0),t("button",{class:m(["h-12 px-6 rounded-lg font-bold tracking-wider flex items-center gap-2 transition-all transform hover:scale-105 active:scale-95 text-white shadow-lg",i.value.tipo==="PEDIDO"?"bg-emerald-600 hover:bg-emerald-500 shadow-emerald-900/50":"bg-purple-600 hover:bg-purple-500 shadow-purple-900/50"]),onClick:ue},[J.value?(s(),r("span",So,[...e[43]||(e[43]=[t("i",{class:"fa-solid fa-circle-notch"},null,-1)])])):(s(),r("span",No,[...e[44]||(e[44]=[t("span",null,"GUARDAR",-1),t("span",{class:"bg-white/20 px-1.5 py-0.5 rounded text-[10px] font-mono opacity-80"},"F10",-1)])]))],2)])])],2),(s(),F(q,{to:"body"},[S.value.show?(s(),F(We,{key:0,modelValue:S.value.show,"onUpdate:modelValue":e[11]||(e[11]=l=>S.value.show=l),x:S.value.x,y:S.value.y,actions:S.value.actions,onClose:e[12]||(e[12]=l=>S.value.show=!1)},null,8,["modelValue","x","y","actions"])):v("",!0),me(ut,{visible:b.value.show,x:b.value.x,y:b.value.y,orders:b.value.orders,onClose:e[13]||(e[13]=l=>b.value.show=!1)},null,8,["visible","x","y","orders"])])),(s(),F(q,{to:"body"},[O.value?(s(),r("div",Po,[t("div",To,[me(Ge,{modelValue:Q.value,isNew:G.value,mode:"compact",onClose:le,onSave:Ue,onDelete:$e,onSwitchClient:Le,onManageSegmentos:ge},null,8,["modelValue","isNew"])])])):v("",!0)])),(s(),F(q,{to:"body"},[Z.value?(s(),F(Xe,{key:0,title:"Administrar Segmentos",items:be.value,onClose:e[14]||(e[14]=l=>Z.value=!1),onCreate:he,onDelete:ye},null,8,["items"])):v("",!0)])),(s(),F(q,{to:"body"},[j.value?(s(),r("div",{key:0,class:"fixed inset-0 z-[70] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:e[16]||(e[16]=P(l=>j.value=!1,["self"]))},[t("div",Uo,[e[46]||(e[46]=t("h3",{class:"text-emerald-400 font-bold mb-4"},"Seleccionar Domicilio / Transporte",-1)),a.value&&a.value.domicilios&&a.value.domicilios.length>0?(s(),r("div",$o,[(s(!0),r(T,null,U(a.value.domicilios,l=>(s(),r("div",{key:l.id,class:"p-2 border border-slate-700 rounded hover:bg-slate-800 cursor-pointer transition-colors",onClick:d=>Ee({transporte_id:l.transporte_id,transporte_nombre:l.transporte?.nombre||"Retiro Local",domicilio_entrega:l.calle+" "+l.numero+" ("+l.localidad+")"})},[t("div",Mo,n(l.calle)+" "+n(l.numero),1),t("div",Ao,n(l.localidad)+" - "+n(l.provincia?.nombre),1),t("div",Fo,[e[45]||(e[45]=t("i",{class:"fa-solid fa-truck"},null,-1)),R(" "+n(l.transporte?.nombre||"Retiro en Local"),1)])],8,Lo))),128))])):(s(),r("div",Ro," El cliente no tiene domicilios registrados. ")),t("button",{onClick:e[15]||(e[15]=l=>j.value=!1),class:"mt-4 w-full bg-slate-800 text-slate-400 hover:text-white py-2 rounded"}," Cancelar ")])])):v("",!0)]))]))}},Ho=je(Vo,[["__scopeId","data-v-22d915d6"]]);export{Ho as default};
