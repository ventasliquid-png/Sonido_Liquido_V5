import{l as U,r as u,m as S,o as Z,p as T,c as l,b as t,i as j,v as E,n as i,d as z,F as I,g as L,q,P as D,h as g,Q as P,t as y,k as n}from"./index-CbJ9Xo6G.js";import{u as Q}from"./productos-Cr0wCfAx.js";import"./productosApi-B95eMTcM.js";const G={class:"flex h-full w-full bg-[#1a050b] text-gray-200 overflow-hidden font-sans"},K={class:"flex flex-1 flex-col relative min-w-0 z-10"},O={class:"relative z-20 flex h-16 items-center justify-between border-b border-rose-900/20 bg-[#2e0a13]/50 px-6 backdrop-blur-sm shrink-0"},H={class:"flex items-center gap-4"},J={class:"relative"},W={class:"flex bg-rose-900/10 rounded-lg p-1 border border-rose-900/20"},X={class:"relative"},Y={key:0},ee={key:1},te={key:2},se={key:3},oe={key:0,class:"absolute right-0 mt-2 w-48 bg-[#2e0a13] border border-rose-500/30 rounded-lg shadow-xl z-50 overflow-hidden"},le={class:"relative z-50 py-1"},ne={class:"flex bg-rose-900/10 rounded-lg p-1 border border-rose-900/20"},ae={class:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-track-rose-900/20 scrollbar-thumb-rose-900/50"},ie={key:0,class:"flex justify-center py-8"},re={key:1,class:"flex flex-col items-center justify-center h-64 text-rose-900/50"},de={key:2},ue={key:0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},ce=["onClick"],ve=["onClick"],fe=["onClick"],xe={key:1,class:"space-y-1"},be=["onClick"],pe={class:"flex items-center gap-3"},ge={class:"font-mono text-xs text-rose-500"},me={class:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity"},he=["onClick"],we=["onClick"],ye={class:"w-96 border-l border-rose-900/20 bg-[#150305] flex flex-col shrink-0 custom-scrollbar overflow-hidden shadow-2xl relative z-30"},ke={key:0,class:"h-full flex flex-col items-center justify-center text-rose-900/20 p-8 text-center select-none"},Ce={key:1,class:"flex flex-col h-full"},_e={class:"h-16 flex items-center justify-between px-6 border-b border-rose-900/20 bg-[#2e0a13]/30 shrink-0"},$e={class:"text-sm font-bold uppercase tracking-wider text-rose-400"},Re={class:"flex-1 p-6 space-y-6 overflow-y-auto"},je={class:"space-y-4"},Ee={class:"flex items-center gap-3 pt-2"},Ve={class:"text-sm text-gray-400"},Ae={class:"p-6 border-t border-rose-900/20 bg-[#2e0a13]/20 shrink-0"},Ne=["disabled"],Se={key:0,class:"fas fa-circle-notch fa-spin"},ze={key:1},Ie={key:0,class:"mt-3 text-center"},Be={__name:"RubrosView",setup(Le){const c=Q(),F=U(),k=u(c.rubros.length===0),m=u(!1),h=u(""),v=u("all"),p=u("grid"),r=u("alpha_asc"),f=u(!1),d=u(null),x=u(!1),a=u({id:null,codigo:"",nombre:"",padre_id:null,activo:!0}),C=S(()=>d.value),_=S(()=>{let o=[...c.rubros];if(h.value){const e=h.value.toLowerCase();o=o.filter(s=>s.nombre.toLowerCase().includes(e)||s.codigo.toLowerCase().includes(e))}return v.value==="active"&&(o=o.filter(e=>e.activo)),v.value==="inactive"&&(o=o.filter(e=>!e.activo)),o.sort((e,s)=>{switch(r.value){case"alpha_asc":return e.nombre.localeCompare(s.nombre);case"alpha_desc":return s.nombre.localeCompare(e.nombre);case"id_desc":return s.id-e.id;case"id_asc":return e.id-s.id;default:return 0}})}),M=async()=>{c.rubros.length===0&&(k.value=!0);try{await c.fetchRubros()}finally{k.value=!1}},B=()=>{x.value=!0,d.value={},a.value={codigo:"",nombre:"",padre_id:null,activo:!0}},V=o=>{x.value=!1,d.value=o,a.value={...o}},w=()=>{d.value=null,x.value=!1},A=async()=>{if(!a.value.codigo||!a.value.nombre){F.add("Datos incompletos","warning");return}m.value=!0;try{const o={...a.value};a.value.id?await c.updateRubro(a.value.id,o):await c.createRubro(o),w()}catch{}finally{m.value=!1}},$=async o=>{try{await c.updateRubro(o.id,{...o,activo:!o.activo}),d.value?.id===o.id&&(a.value.activo=!o.activo)}catch{}},R=async o=>{if(confirm(`¿Eliminar definitivamente el rubro "${o.nombre}"?`))try{await c.deleteRubro(o.id),d.value?.id===o.id&&w()}catch{}},N=o=>{o.key==="F10"&&(o.preventDefault(),(d.value||x.value)&&A()),o.key==="Escape"&&d.value&&w()};return Z(()=>{window.addEventListener("keydown",N),M()}),T(()=>{window.removeEventListener("keydown",N)}),(o,e)=>(n(),l("div",G,[t("main",K,[t("header",O,[e[24]||(e[24]=t("div",{class:"flex items-center gap-3"},[t("h1",{class:"font-outfit text-xl font-semibold text-rose-100"}," Explorador de Rubros "),t("span",{class:"px-2 py-0.5 rounded bg-rose-500/20 text-rose-300 text-[10px] font-bold uppercase tracking-wider border border-rose-500/30"}," Flat View ")],-1)),t("div",H,[t("div",J,[e[15]||(e[15]=t("i",{class:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-rose-400/50"},null,-1)),j(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>h.value=s),type:"text",placeholder:"Buscar rubro...",class:"h-9 w-64 rounded-full border border-rose-900/30 bg-[#0a0204] pl-10 pr-4 text-sm text-rose-100 placeholder-rose-900/50 focus:border-rose-500 focus:outline-none focus:ring-1 focus:ring-rose-500"},null,512),[[E,h.value]])]),e[20]||(e[20]=t("div",{class:"h-6 w-px bg-rose-900/20"},null,-1)),t("div",W,[t("button",{onClick:e[1]||(e[1]=s=>v.value="all"),class:i(["px-3 py-1 text-xs font-medium rounded-md transition-all",v.value==="all"?"bg-rose-600 text-white shadow-sm":"text-rose-100/50 hover:text-rose-100"])}," Todos ",2),t("button",{onClick:e[2]||(e[2]=s=>v.value="active"),class:i(["px-3 py-1 text-xs font-medium rounded-md transition-all",v.value==="active"?"bg-green-600 text-white shadow-sm":"text-rose-100/50 hover:text-rose-100"])}," Activos ",2),t("button",{onClick:e[3]||(e[3]=s=>v.value="inactive"),class:i(["px-3 py-1 text-xs font-medium rounded-md transition-all",v.value==="inactive"?"bg-red-600 text-white shadow-sm":"text-rose-100/50 hover:text-rose-100"])}," Inactivos ",2)]),e[21]||(e[21]=t("div",{class:"h-6 w-px bg-rose-900/20"},null,-1)),t("div",X,[t("button",{onClick:e[4]||(e[4]=s=>f.value=!f.value),class:"flex items-center gap-2 rounded-lg border border-rose-900/20 bg-rose-900/10 px-3 py-1.5 text-xs font-medium text-rose-200 hover:bg-rose-900/20 transition-colors",title:"Ordenar"},[e[16]||(e[16]=t("i",{class:"fas fa-sort-amount-down"},null,-1)),r.value==="alpha_asc"?(n(),l("span",Y,"A-Z")):r.value==="alpha_desc"?(n(),l("span",ee,"Z-A")):r.value==="id_desc"?(n(),l("span",te,"Recientes")):(n(),l("span",se,"ordenar"))]),f.value?(n(),l("div",oe,[t("div",{class:"fixed inset-0 z-40",onClick:e[5]||(e[5]=s=>f.value=!1)}),t("div",le,[t("button",{onClick:e[6]||(e[6]=s=>{r.value="alpha_asc",f.value=!1}),class:i(["block w-full text-left px-4 py-2 text-sm text-rose-100 hover:bg-rose-500/10",{"text-rose-400 font-bold":r.value==="alpha_asc"}])},"A-Z Alfabético",2),t("button",{onClick:e[7]||(e[7]=s=>{r.value="alpha_desc",f.value=!1}),class:i(["block w-full text-left px-4 py-2 text-sm text-rose-100 hover:bg-rose-500/10",{"text-rose-400 font-bold":r.value==="alpha_desc"}])},"Z-A Alfabético",2),t("button",{onClick:e[8]||(e[8]=s=>{r.value="id_desc",f.value=!1}),class:i(["block w-full text-left px-4 py-2 text-sm text-rose-100 hover:bg-rose-500/10",{"text-rose-400 font-bold":r.value==="id_desc"}])},"Más Recientes",2)])])):z("",!0)]),e[22]||(e[22]=t("div",{class:"h-6 w-px bg-rose-900/20"},null,-1)),t("div",ne,[t("button",{onClick:e[9]||(e[9]=s=>p.value="grid"),class:i(["p-1.5 rounded-md transition-all",p.value==="grid"?"bg-rose-500/20 text-rose-400":"text-rose-900/50 hover:text-rose-200"]),title:"Vista Cuadrícula"},[...e[17]||(e[17]=[t("i",{class:"fas fa-border-all"},null,-1)])],2),t("button",{onClick:e[10]||(e[10]=s=>p.value="list"),class:i(["p-1.5 rounded-md transition-all",p.value==="list"?"bg-rose-500/20 text-rose-400":"text-rose-900/50 hover:text-rose-200"]),title:"Vista Lista"},[...e[18]||(e[18]=[t("i",{class:"fas fa-list"},null,-1)])],2)]),e[23]||(e[23]=t("div",{class:"h-6 w-px bg-rose-900/20"},null,-1)),t("button",{onClick:B,class:"ml-2 flex items-center gap-2 rounded-lg bg-orange-600 px-4 py-1.5 text-sm font-bold text-white shadow-lg shadow-orange-500/20 transition-all hover:bg-orange-500 hover:shadow-orange-500/40"},[...e[19]||(e[19]=[t("i",{class:"fas fa-plus"},null,-1),t("span",{class:"hidden sm:inline"},"Nuevo Rubro",-1)])])])]),t("div",ae,[k.value?(n(),l("div",ie,[...e[25]||(e[25]=[t("i",{class:"fa-solid fa-circle-notch fa-spin text-rose-500 text-4xl"},null,-1)])])):_.value.length===0?(n(),l("div",re,[...e[26]||(e[26]=[t("i",{class:"fas fa-search text-4xl mb-4 opacity-50"},null,-1),t("p",null,"No se encontraron rubros.",-1)])])):(n(),l("div",de,[p.value==="grid"?(n(),l("div",ue,[(n(!0),l(I,null,L(_.value,s=>(n(),l("div",{key:s.id,class:"relative w-full min-h-[140px]"},[q(P,{class:"w-full cursor-pointer",title:s.nombre,subtitle:`${s.codigo}`,status:s.activo?"active":"inactive",selected:C.value?.id===s.id,onClick:b=>V(s)},{icon:D(()=>[...e[27]||(e[27]=[t("i",{class:"fas fa-tag"},null,-1)])]),actions:D(()=>[s.activo?(n(),l("button",{key:0,onClick:g(b=>$(s),["stop"]),class:"relative inline-flex h-4 w-7 items-center rounded-full transition-colors focus:outline-none shrink-0 mr-2 bg-green-500/50",title:"Desactivar"},[...e[28]||(e[28]=[t("span",{class:"inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm translate-x-3.5"},null,-1)])],8,ce)):(n(),l("button",{key:1,onClick:g(b=>$(s),["stop"]),class:"relative inline-flex h-4 w-7 items-center rounded-full transition-colors focus:outline-none shrink-0 mr-2 bg-red-500/50",title:"Activar"},[...e[29]||(e[29]=[t("span",{class:"inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm translate-x-1"},null,-1)])],8,ve)),t("button",{onClick:g(b=>R(s),["stop"]),class:"text-rose-900/50 hover:text-red-500 transition-colors",title:"Eliminar Rubro"},[...e[30]||(e[30]=[t("i",{class:"fas fa-trash"},null,-1)])],8,fe)]),_:2},1032,["title","subtitle","status","selected","onClick"])]))),128))])):(n(),l("div",xe,[(n(!0),l(I,null,L(_.value,s=>(n(),l("div",{key:s.id,onClick:b=>V(s),class:i(["flex items-center justify-between p-2 rounded border transition-all cursor-pointer group",C.value?.id===s.id?"bg-rose-900/30 border-rose-500":"bg-transparent border-rose-900/10 hover:bg-rose-900/10"])},[t("div",pe,[t("div",{class:i(["w-2 h-2 rounded-full",s.activo?"bg-green-500":"bg-red-500"])},null,2),t("span",{class:i(["font-bold text-sm",C.value?.id===s.id?"text-white":"text-rose-100"])},y(s.nombre),3),t("span",ge,y(s.codigo),1)]),t("div",me,[t("button",{onClick:g(b=>$(s),["stop"]),class:i(["relative inline-flex h-4 w-7 items-center rounded-full transition-colors focus:outline-none shrink-0",s.activo?"bg-green-500/50":"bg-red-500/50"]),title:"Click para cambiar estado"},[t("span",{class:i(["inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm",s.activo?"translate-x-3.5":"translate-x-1"])},null,2)],10,he),t("button",{onClick:g(b=>R(s),["stop"]),class:"w-6 h-6 rounded bg-rose-500/10 hover:bg-red-600 hover:text-white text-red-400 flex items-center justify-center"},[...e[31]||(e[31]=[t("i",{class:"fas fa-trash text-xs"},null,-1)])],8,we)])],10,be))),128))]))]))])]),t("aside",ye,[!d.value&&!x.value?(n(),l("div",ke,[...e[32]||(e[32]=[t("i",{class:"fas fa-pencil text-6xl mb-4"},null,-1),t("h3",{class:"text-xl font-bold uppercase tracking-widest mb-2 text-rose-900/40"},"Inspector",-1),t("p",{class:"text-sm"},"Seleccione un rubro para ver sus detalles",-1)])])):(n(),l("div",Ce,[t("div",_e,[t("h3",$e,y(x.value?"Nuevo":"Editar")+" Rubro ",1),t("button",{onClick:w,class:"text-gray-500 hover:text-white transition-colors"},[...e[33]||(e[33]=[t("i",{class:"fa-solid fa-times"},null,-1)])])]),t("div",Re,[e[36]||(e[36]=t("div",{class:"flex justify-center mb-4"},[t("div",{class:"w-16 h-16 rounded-full bg-rose-900/10 flex items-center justify-center text-2xl text-rose-500 border border-rose-500/20"},[t("i",{class:"fas fa-tag"})])],-1)),t("div",je,[t("div",null,[e[34]||(e[34]=t("label",{class:"block text-xs font-bold text-gray-500 mb-1 uppercase"},"Código",-1)),j(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>a.value.codigo=s),type:"text",maxlength:"8",class:"w-full bg-black/30 border border-rose-900/30 rounded p-2 text-white font-mono uppercase focus:border-rose-500 outline-none"},null,512),[[E,a.value.codigo]])]),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-xs font-bold text-gray-500 mb-1 uppercase"},"Nombre",-1)),j(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>a.value.nombre=s),type:"text",class:"w-full bg-black/30 border border-rose-900/30 rounded p-2 text-white focus:border-rose-500 outline-none"},null,512),[[E,a.value.nombre]])]),t("div",Ee,[t("button",{onClick:e[13]||(e[13]=s=>a.value.activo=!a.value.activo),class:i(["w-10 h-5 rounded-full relative transition-colors",a.value.activo?"bg-green-600":"bg-gray-700"])},[t("div",{class:i(["absolute top-1 left-1 bg-white w-3 h-3 rounded-full transition-transform",{"translate-x-5":a.value.activo}])},null,2)],2),t("span",Ve,y(a.value.activo?"Activo":"Inactivo"),1)])])]),t("div",Ae,[t("button",{onClick:A,disabled:m.value,class:"w-full py-3 rounded bg-rose-600 font-bold text-sm text-white shadow-lg shadow-rose-600/20 hover:bg-rose-500 transition-all flex items-center justify-center gap-2"},[m.value?(n(),l("i",Se)):(n(),l("span",ze,"Guardar Cambios (F10)"))],8,Ne),x.value?z("",!0):(n(),l("div",Ie,[t("button",{onClick:e[14]||(e[14]=s=>R(d.value)),class:"text-xs text-red-400 hover:text-red-300 underline"}," Eliminar Registro ")]))])]))])]))}};export{Be as default};
