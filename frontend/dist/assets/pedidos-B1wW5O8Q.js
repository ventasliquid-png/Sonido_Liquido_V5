import{L as n,K as d}from"./index-CbJ9Xo6G.js";const p=n("pedidos",{state:()=>({isLoading:!1,pedidos:[]}),actions:{async fetchPedidos(r={}){this.isLoading=!0;try{const e=new URLSearchParams(r),t=await d.get(`/pedidos/?${e.toString()}`);this.pedidos=t.data}catch(e){console.error("Error fetching pedidos:",e)}finally{this.isLoading=!1}},async createPedidoTactico(r){this.isLoading=!0;try{return(await d.post("/pedidos/tactico",r)).data}catch(e){throw console.error("Error creating tactico order:",e),e}finally{this.isLoading=!1}},async getLastPrice(r,e){try{return(await d.get(`/pedidos/historial/${r}/${e}`)).data}catch{return null}},async updatePedido(r,e){try{const t=await d.patch(`/pedidos/${r}`,e),o=this.pedidos.findIndex(i=>i.id===r);return o!==-1&&(this.pedidos[o]=t.data),t.data}catch(t){throw console.error("Error updating pedido:",t),t}},async clonePedido(r){try{const e=await d.post(`/pedidos/${r}/clone`);return this.pedidos.unshift(e.data),e.data}catch(e){throw console.error("Error cloning pedido:",e),e}},async addPedidoItem(r,e){try{const o=(await d.post(`/pedidos/${r}/items`,e)).data,i=this.pedidos.findIndex(s=>s.id===r);return i!==-1&&(this.pedidos[i]=o),o}catch(t){throw console.error("Error adding pedido item:",t),t}},async updatePedidoItem(r,e,t){try{const i=(await d.patch(`/pedidos/items/${e}`,t)).data,s=this.pedidos.findIndex(a=>a.id===r);return s!==-1&&(this.pedidos[s]=i),i}catch(o){throw console.error("Error updating pedido item:",o),o}},async deletePedidoItem(r,e){try{await d.delete(`/pedidos/items/${e}`);const t=this.pedidos.find(o=>o.id===r);if(t){const o=t.items.findIndex(i=>i.id===e);if(o!==-1){const i=t.items[o];t.items.splice(o,1),t.total-=i.cantidad*i.precio_unitario}}}catch(t){throw console.error("Error deleting pedido item:",t),t}},async getHistorialCliente(r){try{return(await d.get(`/pedidos/historial/${r}`)).data}catch{return[]}}}});export{p as u};
