import{M as D,r as k,c as n,k as r,b as e,d as U,N as q,e as E,t as u,n as c,O as J,m as L,w as Z,o as K,p as F,i as f,v as A,B as C,F as S,g as P,f as h,j as G,q as H,P as Q,h as R,D as W,s as X,x as Y}from"./index-CbJ9Xo6G.js";import{u as z}from"./productos-Cr0wCfAx.js";import"./productosApi-B95eMTcM.js";const ee={class:"absolute right-3 top-3 z-30 transform scale-90"},te={key:0,class:"absolute right-8 top-2 text-xs text-yellow-400 font-bold tracking-wider",title:"Es Kit"},oe={class:"flex flex-col"},se={key:0,class:"mb-1"},le={class:"inline-block px-1.5 py-0.5 rounded text-[10px] font-bold bg-rose-500/20 text-rose-300 border border-rose-500/30"},re={class:"flex items-center gap-2 mt-1"},ie={class:"text-xs text-gray-500 font-mono"},ne={key:0,class:"text-xs text-gray-600"},ae={key:1,class:"mt-3 pt-3 border-t border-white/10 text-xs text-white/60 animate-fade-in"},de={class:"flex justify-between items-center"},ue={__name:"ProductoCard",props:{producto:{type:Object,required:!0},selected:{type:Boolean,default:!1}},emits:["select"],setup(p,{emit:a}){const b=k(!1);let m=null;const v=()=>{m=setTimeout(()=>{b.value=!0},800)},_=()=>{m&&clearTimeout(m),b.value=!1};return(g,x)=>(r(),n("div",{class:c(["producto-card group relative flex flex-col rounded-xl border border-white/10 bg-white/5 p-4 transition-all duration-300 hover:border-rose-500/50 hover:bg-white/10 hover:shadow-lg hover:shadow-rose-500/20 cursor-pointer",[{"ring-2 ring-rose-500 bg-white/10":p.selected},b.value?"absolute top-0 left-0 w-full z-50 scale-110 bg-[#3f0e1a] shadow-2xl shadow-black/50 h-auto min-h-[180px]":"overflow-hidden h-[160px]",{"opacity-60":!p.producto.activo}]]),onMouseenter:v,onMouseleave:_},[e("div",ee,[q(g.$slots,"status-action",{},void 0)]),p.producto.es_kit?(r(),n("div",te,[...x[0]||(x[0]=[e("i",{class:"fas fa-box-open"},null,-1),E(" KIT ",-1)])])):U("",!0),x[2]||(x[2]=e("div",{class:"mb-4 flex h-12 w-12 items-center justify-center rounded-lg bg-black/30 text-2xl text-rose-400/50 group-hover:text-rose-400 transition-colors shrink-0"},[e("i",{class:"fas fa-box"})],-1)),e("div",oe,[p.producto.codigo_visual?(r(),n("div",se,[e("span",le,u(p.producto.codigo_visual),1)])):U("",!0),e("h3",{class:c(["font-outfit text-lg font-semibold text-gray-100 group-hover:text-white leading-tight",{truncate:!b.value,"whitespace-normal":b.value}])},u(p.producto.nombre),3),e("div",re,[e("p",ie,"SKU: "+u(p.producto.sku),1),p.producto.rubro?(r(),n("span",ne,"• "+u(p.producto.rubro.nombre),1)):U("",!0)]),b.value?(r(),n("div",ae,[e("div",de,[e("span",null,u(p.producto.unidad_medida),1),x[1]||(x[1]=e("span",{class:"text-rose-400"},"Click para editar",-1))])])):U("",!0)])],34))}},ce=D(ue,[["__scopeId","data-v-b07556ba"]]),be={class:"flex h-full w-full flex-col border-l border-white/10 bg-[#1a050b]/95 backdrop-blur-xl transition-all"},ve={class:"flex items-center justify-between border-b border-white/10 p-4 shrink-0"},fe={key:0,class:"flex-1 flex flex-col overflow-hidden"},xe={class:"p-6 pb-2 text-center shrink-0"},pe={class:"mb-4 flex flex-col items-center gap-3"},me={class:"font-outfit text-xl font-bold text-white leading-tight"},we={class:"font-mono text-sm text-rose-400/70 mt-1"},he={class:"flex border-b border-white/10 px-6 mt-4 shrink-0"},ge={class:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-track-black/20 scrollbar-thumb-rose-900/50"},ye={key:0,class:"space-y-5"},ke={class:"space-y-1"},_e={class:"space-y-1"},$e={class:"space-y-1"},Ce=["value"],Se={class:"space-y-1"},Pe={class:"p-4 rounded-lg bg-white/5 border border-white/10 space-y-4"},Ue={class:"grid grid-cols-2 gap-4"},je={class:"space-y-1"},Ne=["value"],Ve={class:"space-y-1"},Ae=["value"],Te={class:"space-y-1"},Ee={class:"grid grid-cols-2 gap-4"},Me={class:"space-y-1"},Ie={class:"flex items-center justify-center pt-6"},Re={class:"flex items-center gap-3 cursor-pointer group"},Le={class:"relative"},Oe={key:1,class:"space-y-6"},Ke={class:"p-4 rounded-lg bg-rose-500/10 border border-rose-500/20"},Fe={class:"mb-4"},ze=["value"],Be={class:"space-y-4"},De={class:"relative"},qe={class:"grid grid-cols-2 gap-3"},Je=["value"],Ze={class:"space-y-3 pt-2"},Ge={class:"flex justify-between items-center p-3 rounded bg-white/5 border border-white/5"},He={class:"font-mono font-bold text-green-400 text-lg"},Qe={class:"flex justify-between items-center p-2 rounded hover:bg-white/5 transition-colors"},We={class:"font-mono text-white/80"},Xe={class:"flex justify-between items-center p-2 rounded hover:bg-white/5 transition-colors"},Ye={class:"font-mono text-white/80"},et={class:"p-4 border-t border-white/10 bg-black/20 shrink-0 flex gap-3"},tt=["title"],ot={key:1,class:"flex flex-1 flex-col items-center justify-center p-8 text-center text-white/30"},st={__name:"ProductoInspector",props:{producto:{type:Object,default:null},rubros:{type:Array,default:()=>[]}},emits:["close","save","toggle-active"],setup(p,{emit:a}){const b=z(),{unidades:m,tasasIva:v,proveedores:_}=J(b),g=p,x=a,y=k("general"),i=k(null),w=k({costo_reposicion:0,margen_mayorista:0,iva_alicuota:21}),M=L(()=>{const d=[],t=(o,s=0)=>{for(const l of o)d.push({...l,indent:"  ".repeat(s)+(s>0?"└ ":"")}),l.hijos&&l.hijos.length&&t(l.hijos,s+1)};return t(g.rubros),d});Z(()=>g.producto,d=>{d?(i.value=JSON.parse(JSON.stringify(d)),d.costos?w.value={...d.costos}:w.value={costo_reposicion:0,margen_mayorista:30,iva_alicuota:21}):i.value=null},{immediate:!0});const T=L(()=>{const d=Number(w.value.costo_reposicion)||0,t=Number(w.value.margen_mayorista)||0,o=Number(w.value.iva_alicuota)||0,l=d*(1+t/100)*(1+o/100),$=l*1.105,B=$/.9*1.105;return{mayorista:l,distribuidor:$,minorista:B}}),j=d=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(d),N=()=>{if(!i.value)return;const d={...i.value,costos:{...w.value}};x("save",d)},O=()=>{i.value&&x("toggle-active",i.value.id)},V=()=>{const d=v.value.find(t=>t.id===i.value.tasa_iva_id);d&&(w.value.iva_alicuota=Number(d.valor))},I=d=>{d.key==="F10"&&(d.preventDefault(),N())};return K(()=>{window.addEventListener("keydown",I),b.fetchUnidades(),b.fetchTasasIva(),b.fetchProveedores()}),F(()=>window.removeEventListener("keydown",I)),(d,t)=>(r(),n("div",be,[e("div",ve,[t[18]||(t[18]=e("h2",{class:"font-outfit text-sm font-bold uppercase tracking-wider text-rose-400"},"Inspector de Producto",-1)),e("button",{onClick:t[0]||(t[0]=o=>d.$emit("close")),class:"text-white/50 hover:text-white"},[...t[17]||(t[17]=[e("i",{class:"fas fa-times"},null,-1)])])]),i.value?(r(),n("div",fe,[e("div",xe,[e("div",pe,[e("button",{onClick:t[1]||(t[1]=o=>d.$emit("toggle-active",i.value)),class:c(["relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none bg-black/40 border border-white/10",i.value.activo?"border-green-500/50":"border-red-500/50"]),title:"Click para cambiar estado"},[e("span",{class:c(["inline-block h-3 w-3 transform rounded-full transition-transform shadow-sm",i.value.activo?"translate-x-5 bg-green-400":"translate-x-1 bg-red-400"])},null,2)],2),t[19]||(t[19]=e("div",{class:"flex h-20 w-20 items-center justify-center rounded-xl bg-gradient-to-br from-[#3f0e1a] to-black text-4xl text-rose-500 shadow-lg border border-rose-500/20"},[e("i",{class:"fas fa-box"})],-1))]),e("h3",me,u(i.value.nombre),1),e("p",we,"SKU: "+u(i.value.sku),1)]),e("div",he,[e("button",{onClick:t[2]||(t[2]=o=>y.value="general"),class:c(["pb-2 px-4 text-sm font-medium transition-colors border-b-2",y.value==="general"?"border-rose-500 text-white":"border-transparent text-white/50 hover:text-white"])}," GENERAL ",2),e("button",{onClick:t[3]||(t[3]=o=>y.value="costos"),class:c(["pb-2 px-4 text-sm font-medium transition-colors border-b-2",y.value==="costos"?"border-rose-500 text-white":"border-transparent text-white/50 hover:text-white"])}," COSTOS ",2)]),e("div",ge,[y.value==="general"?(r(),n("div",ye,[e("div",ke,[t[20]||(t[20]=e("label",{class:"text-xs font-bold text-white/60 uppercase"},"Nombre del Producto",-1)),f(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>i.value.nombre=o),type:"text",class:"w-full bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-rose-500 focus:outline-none transition-colors",placeholder:"Ej: Jabón Líquido 5L"},null,512),[[A,i.value.nombre]])]),e("div",_e,[t[21]||(t[21]=e("label",{class:"text-xs font-bold text-white/60 uppercase"},"Código Visual",-1)),f(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>i.value.codigo_visual=o),type:"text",class:"w-full bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-rose-500 focus:outline-none transition-colors font-mono",placeholder:"Ej: JL-500"},null,512),[[A,i.value.codigo_visual]])]),e("div",$e,[t[23]||(t[23]=e("label",{class:"text-xs font-bold text-white/60 uppercase"},"Rubro / Categoría",-1)),f(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>i.value.rubro_id=o),class:"w-full bg-[#1a050b] border border-white/10 rounded-lg px-3 py-2 text-white focus:border-rose-500 focus:outline-none transition-colors appearance-none"},[t[22]||(t[22]=e("option",{value:null,disabled:"",class:"bg-[#1a050b] text-white"},"Seleccione un Rubro",-1)),(r(!0),n(S,null,P(M.value,o=>(r(),n("option",{key:o.id,value:o.id,class:"bg-[#1a050b] text-white"},u(o.indent)+u(o.nombre),9,Ce))),128))],512),[[C,i.value.rubro_id]])]),e("div",Se,[t[25]||(t[25]=e("label",{class:"text-xs font-bold text-white/60 uppercase"},"Tipo Producto",-1)),f(e("select",{"onUpdate:modelValue":t[7]||(t[7]=o=>i.value.tipo_producto=o),class:"w-full bg-[#1a050b] border border-white/10 rounded-lg px-3 py-2 text-white focus:border-rose-500 focus:outline-none transition-colors appearance-none"},[...t[24]||(t[24]=[e("option",{value:"VENTA",class:"bg-[#1a050b] text-white"},"Venta",-1),e("option",{value:"INSUMO",class:"bg-[#1a050b] text-white"},"Insumo",-1),e("option",{value:"MATERIA_PRIMA",class:"bg-[#1a050b] text-white"},"Materia Prima",-1),e("option",{value:"SERVICIO",class:"bg-[#1a050b] text-white"},"Servicio",-1)])],512),[[C,i.value.tipo_producto]])]),e("div",Pe,[t[31]||(t[31]=e("h4",{class:"text-rose-400 text-xs font-bold uppercase flex items-center gap-2"},[e("i",{class:"fas fa-truck-loading"}),E(" Logística de Unidades ")],-1)),e("div",Ue,[e("div",je,[t[27]||(t[27]=e("label",{class:"text-xs font-bold text-white/60 uppercase"},"Unidad Stock",-1)),f(e("select",{"onUpdate:modelValue":t[8]||(t[8]=o=>i.value.unidad_stock_id=o),class:"w-full bg-[#1a050b] border border-white/10 rounded-lg px-3 py-2 text-white focus:border-rose-500 focus:outline-none transition-colors appearance-none"},[t[26]||(t[26]=e("option",{value:null,class:"bg-[#1a050b] text-white"},"Seleccionar...",-1)),(r(!0),n(S,null,P(h(m),o=>(r(),n("option",{key:o.id,value:o.id,class:"bg-[#1a050b] text-white"},u(o.nombre)+" ("+u(o.codigo)+") ",9,Ne))),128))],512),[[C,i.value.unidad_stock_id]])]),e("div",Ve,[t[29]||(t[29]=e("label",{class:"text-xs font-bold text-white/60 uppercase"},"Unidad Compra",-1)),f(e("select",{"onUpdate:modelValue":t[9]||(t[9]=o=>i.value.unidad_compra_id=o),class:"w-full bg-[#1a050b] border border-white/10 rounded-lg px-3 py-2 text-white focus:border-rose-500 focus:outline-none transition-colors appearance-none"},[t[28]||(t[28]=e("option",{value:null,class:"bg-[#1a050b] text-white"},"Seleccionar...",-1)),(r(!0),n(S,null,P(h(m),o=>(r(),n("option",{key:o.id,value:o.id,class:"bg-[#1a050b] text-white"},u(o.nombre)+" ("+u(o.codigo)+") ",9,Ae))),128))],512),[[C,i.value.unidad_compra_id]])])]),e("div",Te,[t[30]||(t[30]=e("label",{class:"text-xs font-bold text-white/60 uppercase"},"Factor Conversión (Compra -> Stock)",-1)),f(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>i.value.factor_compra=o),type:"number",step:"0.01",class:"w-full bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-rose-500 focus:outline-none transition-colors font-mono",placeholder:"Ej: 1.00"},null,512),[[A,i.value.factor_compra,void 0,{number:!0}]])])]),e("div",Ee,[e("div",Me,[t[33]||(t[33]=e("label",{class:"text-xs font-bold text-white/60 uppercase"},"Unidad",-1)),f(e("select",{"onUpdate:modelValue":t[11]||(t[11]=o=>i.value.unidad_medida=o),class:"w-full bg-[#1a050b] border border-white/10 rounded-lg px-3 py-2 text-white focus:border-rose-500 focus:outline-none transition-colors"},[...t[32]||(t[32]=[e("option",{value:"UN",class:"bg-[#1a050b] text-white"},"Unidad",-1),e("option",{value:"LT",class:"bg-[#1a050b] text-white"},"Litro",-1),e("option",{value:"KG",class:"bg-[#1a050b] text-white"},"Kilo",-1),e("option",{value:"MT",class:"bg-[#1a050b] text-white"},"Metro",-1)])],512),[[C,i.value.unidad_medida]])]),e("div",Ie,[e("label",Re,[e("div",Le,[f(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=o=>i.value.es_kit=o),class:"peer sr-only"},null,512),[[G,i.value.es_kit]]),t[34]||(t[34]=e("div",{class:"h-6 w-11 rounded-full bg-white/10 peer-checked:bg-rose-500 transition-colors"},null,-1)),t[35]||(t[35]=e("div",{class:"absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition-transform peer-checked:translate-x-5"},null,-1))]),t[36]||(t[36]=e("span",{class:"text-sm font-medium text-white/70 group-hover:text-white transition-colors"},"Es Kit",-1))])])])])):U("",!0),y.value==="costos"?(r(),n("div",Oe,[e("div",Ke,[t[44]||(t[44]=e("h4",{class:"text-rose-400 text-xs font-bold uppercase mb-3 flex items-center gap-2"},[e("i",{class:"fas fa-coins"}),E(" Estructura de Costos ")],-1)),e("div",Fe,[t[38]||(t[38]=e("label",{class:"text-xs text-white/60 block mb-1"},"Proveedor Habitual",-1)),f(e("select",{"onUpdate:modelValue":t[13]||(t[13]=o=>i.value.proveedor_habitual_id=o),class:"w-full bg-[#1a050b] border border-white/10 rounded px-3 py-2 text-white focus:border-rose-500 focus:outline-none appearance-none"},[t[37]||(t[37]=e("option",{value:null,class:"bg-[#1a050b] text-white"},"Seleccionar Proveedor...",-1)),(r(!0),n(S,null,P(h(_),o=>(r(),n("option",{key:o.id,value:o.id,class:"bg-[#1a050b] text-white"},u(o.razon_social||o.nombre),9,ze))),128))],512),[[C,i.value.proveedor_habitual_id]])]),e("div",Be,[e("div",null,[t[40]||(t[40]=e("label",{class:"text-xs text-white/60 block mb-1"},"Costo Reposición (Neto)",-1)),e("div",De,[t[39]||(t[39]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-white/30"},"$",-1)),f(e("input",{"onUpdate:modelValue":t[14]||(t[14]=o=>w.value.costo_reposicion=o),type:"number",step:"0.01",class:"w-full bg-black/40 border border-white/10 rounded px-3 py-2 pl-7 text-white font-mono focus:border-rose-500 focus:outline-none"},null,512),[[A,w.value.costo_reposicion,void 0,{number:!0}]])])]),e("div",qe,[e("div",null,[t[41]||(t[41]=e("label",{class:"text-xs text-white/60 block mb-1"},"Margen Mayorista %",-1)),f(e("input",{"onUpdate:modelValue":t[15]||(t[15]=o=>w.value.margen_mayorista=o),type:"number",step:"0.1",class:"w-full bg-black/40 border border-white/10 rounded px-3 py-2 text-white font-mono focus:border-rose-500 focus:outline-none text-right"},null,512),[[A,w.value.margen_mayorista,void 0,{number:!0}]])]),e("div",null,[t[43]||(t[43]=e("label",{class:"text-xs text-white/60 block mb-1"},"Alícuota IVA",-1)),f(e("select",{"onUpdate:modelValue":t[16]||(t[16]=o=>i.value.tasa_iva_id=o),class:"w-full bg-[#1a050b] border border-white/10 rounded px-3 py-2 text-white font-mono focus:border-rose-500 focus:outline-none appearance-none text-right",onChange:V},[t[42]||(t[42]=e("option",{value:null,class:"bg-[#1a050b] text-white"},"Seleccionar...",-1)),(r(!0),n(S,null,P(h(v),o=>(r(),n("option",{key:o.id,value:o.id,class:"bg-[#1a050b] text-white"},u(o.nombre)+" ("+u(o.valor)+"%) ",9,Je))),128))],544),[[C,i.value.tasa_iva_id]])])])])]),e("div",Ze,[t[48]||(t[48]=e("h4",{class:"text-white/40 text-xs font-bold uppercase text-center"},"Simulador de Precios (Estimado)",-1)),e("div",Ge,[t[45]||(t[45]=e("span",{class:"text-sm text-white/70"},"Precio Mayorista",-1)),e("span",He,u(j(T.value.mayorista)),1)]),e("div",Qe,[t[46]||(t[46]=e("span",{class:"text-xs text-white/50"},"Distribuidor (+10.5%)",-1)),e("span",We,u(j(T.value.distribuidor)),1)]),e("div",Xe,[t[47]||(t[47]=e("span",{class:"text-xs text-white/50"},"Minorista (+40%)",-1)),e("span",Ye,u(j(T.value.minorista)),1)])])])):U("",!0)]),e("div",et,[e("button",{onClick:N,class:"flex-1 bg-rose-600 hover:bg-rose-500 text-white font-bold py-2 px-4 rounded-lg shadow-lg shadow-rose-900/20 transition-all active:scale-95"},[...t[49]||(t[49]=[e("i",{class:"fas fa-save mr-2"},null,-1),E(" Guardar (F10) ",-1)])]),i.value.id?(r(),n("button",{key:0,onClick:O,class:"px-3 py-2 rounded-lg border border-white/10 hover:bg-white/10 text-white/50 hover:text-white transition-colors",title:i.value.activo?"Desactivar":"Reactivar"},[e("i",{class:c(["fas",i.value.activo?"fa-trash":"fa-undo"])},null,2)],8,tt)):U("",!0)])])):(r(),n("div",ot,[...t[50]||(t[50]=[e("i",{class:"fas fa-box-open mb-4 text-4xl opacity-50"},null,-1),e("p",{class:"text-sm"},"Selecciona un producto para editar",-1)])]))]))}},lt={class:"flex h-screen w-full overflow-hidden bg-[#1a050b]"},rt={class:"flex flex-1 flex-col min-w-0 relative"},it={class:"flex items-center justify-between border-b border-white/10 bg-[#2e0a13]/90 px-6 py-4 backdrop-blur-md z-30 shrink-0"},nt={class:"flex items-center gap-4"},at={class:"relative w-64 group"},dt={class:"flex items-center gap-3"},ut=["value"],ct={class:"flex bg-black/20 rounded-lg p-1 border border-white/10"},bt={class:"relative"},vt={class:"flex items-center gap-2"},ft={key:0},xt={key:1},pt={key:2},mt={key:3},wt={key:0,class:"absolute right-0 mt-2 w-48 bg-[#2e0a13] border border-rose-500/30 rounded-lg shadow-xl z-50 overflow-hidden"},ht={class:"relative z-50 py-1"},gt={class:"flex bg-white/5 rounded-lg p-1 border border-white/10"},yt={class:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-rose-900/50"},kt={key:0,class:"flex h-full items-center justify-center"},_t={key:1,class:"flex h-full flex-col items-center justify-center text-white/30"},$t={key:2},Ct={key:0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},St=["onClick"],Pt=["onClick"],Ut={key:1,class:"space-y-1"},jt=["onClick"],Nt={class:"flex items-center gap-3 flex-1 min-w-0"},Vt={class:"min-w-0"},At={class:"font-bold text-rose-100 text-sm truncate"},Tt={class:"text-[10px] text-rose-400/50 block md:hidden"},Et={class:"w-32 hidden md:block text-xs text-rose-200/50 truncate pr-2"},Mt={class:"w-24 text-center hidden md:block"},It={class:"text-xs font-mono text-rose-400"},Rt={class:"w-24 flex justify-center"},Lt=["onClick"],Ot={class:"w-10 flex justify-end opacity-0 group-hover:opacity-100 transition-opacity"},Kt=["onClick"],Ft={class:"w-96 border-l border-white/10 bg-[#2e0a13]/95 flex flex-col z-50 shadow-xl overflow-hidden shrink-0"},zt={key:0,class:"flex flex-col items-center justify-center h-full text-white/30 p-6 text-center"},Jt={__name:"ProductosView",setup(p){Y();const a=z(),b=k(!1),m=k(null),v=k("alpha_asc"),_=k("grid"),g=k(!1),x=k("active");let y=null;const i=L(()=>a.rubros),w=o=>i.value.find(s=>s.id===o)?.nombre||"-",M=L(()=>[...a.productos].sort((s,l)=>{switch(v.value){case"alpha_asc":return s.nombre.localeCompare(l.nombre);case"alpha_desc":return l.nombre.localeCompare(s.nombre);case"id_desc":return l.id-s.id;default:return 0}})),T=()=>{y&&clearTimeout(y),y=setTimeout(()=>{a.fetchProductos()},300)},j=o=>{x.value=o,o==="all"?a.filters.activo=null:o==="active"?a.filters.activo=!0:o==="inactive"&&(a.filters.activo=!1),a.fetchProductos()},N=async o=>{m.value=o.id,await a.fetchProductoById(o.id),b.value=!0},O=()=>{m.value=null,a.currentProducto={nombre:"",sku:"AUTO",codigo_visual:"",rubro_id:null,unidad_medida:"UN",activo:!0,es_kit:!1,costos:{costo_reposicion:0,margen_mayorista:30,iva_alicuota:21},tipo_producto:"VENTA",unidad_stock_id:null,unidad_compra_id:null,factor_compra:1,proveedor_habitual_id:null,tasa_iva_id:null},b.value=!0},V=()=>{b.value=!1,m.value=null,a.currentProducto=null},I=async o=>{try{o.id?await a.updateProducto(o.id,o):await a.createProducto(o),V()}catch{}},d=async o=>{const s=!o.activo;if(o.activo&&!s&&!confirm(`¿Está seguro de desactivar el producto "${o.nombre}"?`))return;await a.toggleEstado(o.id);const l=a.filters.activo;l!==null&&l!==s&&(await a.fetchProductos(),m.value===o.id&&V())},t=o=>{if(o.key==="F3"){o.preventDefault();const s=document.querySelector('input[type="text"]');s&&s.focus()}o.key==="Escape"&&b.value&&V()};return K(async()=>{window.addEventListener("keydown",t),await Promise.all([a.fetchRubros(),a.fetchProductos()])}),F(()=>{window.removeEventListener("keydown",t)}),(o,s)=>(r(),n("div",lt,[e("main",rt,[e("div",it,[e("div",nt,[s[14]||(s[14]=e("h1",{class:"font-outfit text-2xl font-bold text-white"},[e("i",{class:"fas fa-boxes mr-2 text-rose-500"}),E(" Productos ")],-1)),e("div",at,[s[13]||(s[13]=e("i",{class:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-white/30 group-focus-within:text-rose-400 transition-colors"},null,-1)),f(e("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>h(a).filters.search=l),onInput:T,type:"text",placeholder:"Buscar por Nombre, SKU o Código (F3)...",class:"w-full rounded-lg border border-white/10 bg-black/20 py-2 pl-10 pr-4 text-sm text-white placeholder-white/30 focus:border-rose-500 focus:bg-black/40 focus:outline-none transition-all"},null,544),[[A,h(a).filters.search]])])]),e("div",dt,[f(e("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>h(a).filters.rubro_id=l),onChange:s[2]||(s[2]=l=>h(a).fetchProductos()),class:"rounded-lg border border-white/10 bg-[#1a050b] text-white px-3 py-2 text-sm focus:border-rose-500 focus:outline-none"},[s[15]||(s[15]=e("option",{value:null,class:"bg-[#1a050b] text-white"},"Todos los Rubros",-1)),(r(!0),n(S,null,P(i.value,l=>(r(),n("option",{key:l.id,value:l.id,class:"bg-[#1a050b] text-white"},u(l.indent)+u(l.nombre),9,ut))),128))],544),[[C,h(a).filters.rubro_id]]),e("div",ct,[e("button",{onClick:s[3]||(s[3]=l=>j("all")),class:c(["px-3 py-1.5 text-xs font-bold rounded-md transition-all",x.value==="all"?"bg-indigo-600/70 text-white shadow-md ring-1 ring-indigo-500":"text-white/40 hover:text-white hover:bg-white/5"])}," Todos ",2),e("button",{onClick:s[4]||(s[4]=l=>j("active")),class:c(["px-3 py-1.5 text-xs font-bold rounded-md transition-all",x.value==="active"?"bg-green-600/70 text-white shadow-md ring-1 ring-green-500":"text-white/40 hover:text-white hover:bg-white/5"])}," Activos ",2),e("button",{onClick:s[5]||(s[5]=l=>j("inactive")),class:c(["px-3 py-1.5 text-xs font-bold rounded-md transition-all",x.value==="inactive"?"bg-red-600/70 text-white shadow-md ring-1 ring-red-500":"text-white/40 hover:text-white hover:bg-white/5"])}," Inactivos ",2)]),e("div",bt,[e("button",{onClick:s[6]||(s[6]=l=>g.value=!g.value),class:"flex items-center gap-2 rounded-lg border border-white/10 bg-black/20 px-3 py-2 text-sm text-white hover:bg-white/5 transition-colors min-w-[140px] justify-between",title:"Ordenar"},[e("div",vt,[s[16]||(s[16]=e("i",{class:"fas fa-sort-amount-down text-rose-500"},null,-1)),v.value==="alpha_asc"?(r(),n("span",ft,"A-Z")):v.value==="alpha_desc"?(r(),n("span",xt,"Z-A")):v.value==="id_desc"?(r(),n("span",pt,"Recientes")):(r(),n("span",mt,"Ordenar"))]),s[17]||(s[17]=e("i",{class:"fas fa-chevron-down text-xs opacity-50"},null,-1))]),g.value?(r(),n("div",wt,[e("div",{class:"fixed inset-0 z-40",onClick:s[7]||(s[7]=l=>g.value=!1)}),e("div",ht,[e("button",{onClick:s[8]||(s[8]=l=>{v.value="alpha_asc",g.value=!1}),class:c(["block w-full text-left px-4 py-2 text-sm text-rose-100 hover:bg-rose-500/10",{"text-rose-400 font-bold":v.value==="alpha_asc"}])},"A-Z Alfabético",2),e("button",{onClick:s[9]||(s[9]=l=>{v.value="alpha_desc",g.value=!1}),class:c(["block w-full text-left px-4 py-2 text-sm text-rose-100 hover:bg-rose-500/10",{"text-rose-400 font-bold":v.value==="alpha_desc"}])},"Z-A Alfabético",2),e("button",{onClick:s[10]||(s[10]=l=>{v.value="id_desc",g.value=!1}),class:c(["block w-full text-left px-4 py-2 text-sm text-rose-100 hover:bg-rose-500/10",{"text-rose-400 font-bold":v.value==="id_desc"}])},"Más Recientes",2)])])):U("",!0)]),e("div",gt,[e("button",{onClick:s[11]||(s[11]=l=>_.value="grid"),class:c(["p-1.5 rounded-md transition-all",_.value==="grid"?"bg-rose-500/20 text-rose-400":"text-white/30 hover:text-white"]),title:"Vista Cuadrícula"},[...s[18]||(s[18]=[e("i",{class:"fas fa-border-all"},null,-1)])],2),e("button",{onClick:s[12]||(s[12]=l=>_.value="list"),class:c(["p-1.5 rounded-md transition-all",_.value==="list"?"bg-rose-500/20 text-rose-400":"text-white/30 hover:text-white"]),title:"Vista Lista"},[...s[19]||(s[19]=[e("i",{class:"fas fa-list"},null,-1)])],2)]),e("button",{onClick:O,class:"flex items-center gap-2 rounded-lg bg-rose-600 px-4 py-2 text-sm font-bold text-white shadow-lg shadow-rose-900/20 transition-transform hover:bg-rose-500 active:scale-95"},[...s[20]||(s[20]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"Nuevo",-1)])])])]),e("div",yt,[h(a).loading?(r(),n("div",kt,[...s[21]||(s[21]=[e("div",{class:"h-12 w-12 animate-spin rounded-full border-4 border-rose-500 border-t-transparent"},null,-1)])])):h(a).productos.length===0?(r(),n("div",_t,[...s[22]||(s[22]=[e("i",{class:"fas fa-search mb-4 text-4xl opacity-50"},null,-1),e("p",null,"No se encontraron productos",-1)])])):(r(),n("div",$t,[_.value==="grid"?(r(),n("div",Ct,[(r(!0),n(S,null,P(M.value,l=>(r(),n("div",{key:l.id,class:"relative min-h-[160px]"},[H(ce,{producto:l,selected:m.value===l.id,class:"w-full",onClick:$=>N(l),onSelect:$=>N(l)},{"status-action":Q(()=>[l.activo?(r(),n("button",{key:0,onClick:R($=>d(l),["stop"]),class:"relative inline-flex h-4 w-7 items-center rounded-full transition-colors focus:outline-none shrink-0 bg-green-500/50",title:"Desactivar"},[...s[23]||(s[23]=[e("span",{class:"inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm translate-x-3.5"},null,-1)])],8,St)):(r(),n("button",{key:1,onClick:R($=>d(l),["stop"]),class:"relative inline-flex h-4 w-7 items-center rounded-full transition-colors focus:outline-none shrink-0 bg-red-500/50",title:"Activar"},[...s[24]||(s[24]=[e("span",{class:"inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm translate-x-1"},null,-1)])],8,Pt))]),_:2},1032,["producto","selected","onClick","onSelect"])]))),128))])):(r(),n("div",Ut,[s[27]||(s[27]=W('<div class="flex items-center justify-between px-4 py-2 text-xs font-bold text-rose-900/50 uppercase tracking-wider border-b border-white/5 mb-2"><div class="flex-1">Producto</div><div class="w-32 hidden md:block">Rubro</div><div class="w-24 text-center">SKU</div><div class="w-24 text-center">Estado</div><div class="w-10"></div></div>',1)),(r(!0),n(S,null,P(M.value,l=>(r(),n("div",{key:l.id,onClick:$=>N(l),class:c(["group flex items-center justify-between p-2 rounded-lg border border-transparent hover:bg-rose-900/10 hover:border-rose-900/20 cursor-pointer transition-all",{"bg-rose-900/20 border-rose-500/30":m.value===l.id}])},[e("div",Nt,[s[25]||(s[25]=e("div",{class:"h-8 w-8 rounded bg-[#2e0a13] flex items-center justify-center text-rose-500 border border-rose-900/30"},[e("i",{class:"fas fa-box text-xs"})],-1)),e("div",Vt,[e("div",At,u(l.nombre),1),e("div",Tt,u(l.sku),1)])]),e("div",Et,u(w(l.rubro_id)),1),e("div",Mt,[e("span",It,u(l.sku),1)]),e("div",Rt,[e("button",{onClick:R($=>d(l),["stop"]),class:c(["relative inline-flex h-4 w-7 items-center rounded-full transition-colors focus:outline-none shrink-0",l.activo?"bg-green-500/50":"bg-red-500/50"]),title:"Click para cambiar estado"},[e("span",{class:c(["inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm",l.activo?"translate-x-3.5":"translate-x-1"])},null,2)],10,Lt)]),e("div",Ot,[e("button",{onClick:R($=>N(l),["stop"]),class:"text-rose-400 hover:text-white"},[...s[26]||(s[26]=[e("i",{class:"fas fa-pencil"},null,-1)])],8,Kt)])],10,jt))),128))]))]))])]),e("aside",Ft,[b.value?(r(),X(st,{key:1,class:"h-full flex flex-col",producto:h(a).currentProducto,rubros:h(a).rubros,onClose:V,onSave:I,onToggleActive:d},null,8,["producto","rubros"])):(r(),n("div",zt,[...s[28]||(s[28]=[e("i",{class:"fas fa-box-open text-4xl mb-4"},null,-1),e("p",null,'Seleccione un producto para ver propiedades o presione "Nuevo"',-1)])]))])]))}};export{Jt as default};
